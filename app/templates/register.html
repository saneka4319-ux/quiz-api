{% extends "base.html" %}

{% block title %}–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Äî Quiz API{% endblock %}

{% block content %}
<div class="card">
  <h2>üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
  <p>–°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–µ—Å—Ç—ã.</p>
  <form id="registerForm" style="margin-top: 1rem;">
    <div class="field">
      <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
      <input type="text" id="username" name="username" required minlength="3">
    </div>
    <div class="field">
      <label for="password">–ü–∞—Ä–æ–ª—å (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)</label>
      <input type="password" id="password" name="password" required minlength="6">
    </div>
    <button type="submit" class="btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    <p style="margin-top: 1rem;">
      –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="/login" style="color: var(--primary);">–í–æ–π—Ç–∏</a>
    </p>
    {% if error %}
      <div class="error">{{ error }}</div>
    {% endif %}
  </form>
</div>

<script>
  document.getElementById('registerForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const res = await fetch('/auth/register', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({username, password})
    });
    if (res.ok) {
      alert('‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ.');
      window.location.href = '/login';
    } else {
      const err = await res.json();
      alert('‚ùå –û—à–∏–±–∫–∞: ' + (err.detail || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è'));
    }
  });
</script>
{% endblock %}